!function(global){function createCookie(a,b,c){var e,d=new Date;d.setTime(d.getTime()+1e3*60*60*24*c),e="; expires="+d.toGMTString(),document.cookie=a+"="+b+e+"; path=/"}function readCookie(a){var d,e,f,b=a+"=",c=document.cookie.split(";");for(d=0,e=c.length;e>d;d++){for(f=c[d];" "===f.charAt(0);)f=f.substring(1,f.length);if(0===f.indexOf(b))return f.substring(b.length,f.length)}return null}function QiniuJsSDK(){function log(a,b){var e,c="[qiniu-js-sdk]["+a+"]",d=c;for(e=0;e<b.length;e++)d+="string"==typeof b[e]?" "+b[e]:" "+that.stringifyJSON(b[e]);that.detectIEVersion()?console.log(d):(b.unshift(c),console.log.apply(console,b)),document.getElementById("qiniu-js-sdk-log")&&(document.getElementById("qiniu-js-sdk-log").innerHTML+="<p>"+d+"</p>")}function makeLogFunc(a){var b=a.toLowerCase();logger[b]=function(){if(window.console&&window.console.log&&logger.level>=logger[a]){var c=Array.prototype.slice.call(arguments);log(b,c)}}}var logger,property,qiniuUploadUrl,qiniuUploadUrls,qiniuUpHosts,changeUrlTimes,that=this;this.detectIEVersion=function(){for(var a=4,b=document.createElement("div"),c=b.getElementsByTagName("i");b.innerHTML="<!--[if gt IE "+a+"]><i></i><![endif]-->",c[0];)a++;return a>4?a:!1},logger={MUTE:0,FATA:1,ERROR:2,WARN:3,INFO:4,DEBUG:5,TRACE:6,level:0};for(property in logger)logger.hasOwnProperty(property)&&"number"==typeof logger[property]&&!logger.hasOwnProperty(property.toLowerCase())&&makeLogFunc(property);qiniuUploadUrl="https:"===window.location.protocol?"https://up.qbox.me":"http://upload.qiniu.com",qiniuUploadUrls=["http://upload.qiniu.com","http://up.qiniu.com"],qiniuUpHosts={http:["http://upload.qiniu.com","http://up.qiniu.com"],https:["https://up.qbox.me"]},changeUrlTimes=0,this.resetUploadUrl=function(){var a="https:"===window.location.protocol?qiniuUpHosts.https:qiniuUpHosts.http,b=changeUrlTimes%a.length;qiniuUploadUrl=a[b],changeUrlTimes++,logger.debug("resetUploadUrl: "+qiniuUploadUrl)},this.isImage=function(a){return a=a.split(/[?#]/)[0],/\.(png|jpg|jpeg|gif|bmp)$/i.test(a)},this.getFileExtension=function(a){var c,b=a.split(".");return c=1===b.length||""===b[0]&&2===b.length?"":b.pop().toLowerCase()},this.utf8_encode=function(a){var b,d,e,c,f,g,h,i,j;if(null===a||"undefined"==typeof a)return"";for(b=a+"",c="",f=0,d=e=0,f=b.length,g=0;f>g;g++){if(h=b.charCodeAt(g),i=null,128>h)e++;else if(h>127&&2048>h)i=String.fromCharCode(192|h>>6,128|63&h);else if(63488&h^!0)i=String.fromCharCode(224|h>>12,128|63&h>>6,128|63&h);else{if(64512&h^!0)throw new RangeError("Unmatched trail surrogate at "+g);if(j=b.charCodeAt(++g),64512&j^!0)throw new RangeError("Unmatched lead surrogate at "+(g-1));h=((1023&h)<<10)+(1023&j)+65536,i=String.fromCharCode(240|h>>18,128|63&h>>12,128|63&h>>6,128|63&h)}null!==i&&(e>d&&(c+=b.slice(d,e)),c+=i,d=e=g+1)}return e>d&&(c+=b.slice(d,f)),c},this.base64_decode=function(a){var c,d,e,f,g,h,i,j,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",k=0,l=0,m="",n=[];if(!a)return a;a+="";do f=b.indexOf(a.charAt(k++)),g=b.indexOf(a.charAt(k++)),h=b.indexOf(a.charAt(k++)),i=b.indexOf(a.charAt(k++)),j=f<<18|g<<12|h<<6|i,c=255&j>>16,d=255&j>>8,e=255&j,n[l++]=64===h?String.fromCharCode(c):64===i?String.fromCharCode(c,d):String.fromCharCode(c,d,e);while(k<a.length);return m=n.join("")},this.base64_encode=function(a){var c,d,e,f,g,h,i,j,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",k=0,l=0,m="",n=[];if(!a)return a;a=this.utf8_encode(a+"");do c=a.charCodeAt(k++),d=a.charCodeAt(k++),e=a.charCodeAt(k++),j=c<<16|d<<8|e,f=63&j>>18,g=63&j>>12,h=63&j>>6,i=63&j,n[l++]=b.charAt(f)+b.charAt(g)+b.charAt(h)+b.charAt(i);while(k<a.length);switch(m=n.join(""),a.length%3){case 1:m=m.slice(0,-2)+"==";break;case 2:m=m.slice(0,-1)+"="}return m},this.URLSafeBase64Encode=function(a){return a=this.base64_encode(a),a.replace(/\//g,"_").replace(/\+/g,"-")},this.URLSafeBase64Decode=function(a){return a=a.replace(/_/g,"/").replace(/-/g,"+"),this.base64_decode(a)},this.createAjax=function(){var b={};return b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},this.parseJSON=function(data){var rx_dangerous,text;return window.JSON&&window.JSON.parse?window.JSON.parse(data):(rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,text=String(data),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),eval("("+text+")"))},this.stringifyJSON=function(a){var b,c,d,e,f;if(window.JSON&&window.JSON.stringify)return window.JSON.stringify(a);switch(typeof a){case"string":return'"'+a.replace(/(["\\])/g,"\\$1")+'"';case"array":return"["+a.map(that.stringifyJSON).join(",")+"]";case"object":if(a instanceof Array){for(b=[],c=a.length,d=0;c>d;d++)b.push(that.stringifyJSON(a[d]));return"["+b.join(",")+"]"}if(null===a)return"null";e=[];for(f in a)a.hasOwnProperty(f)&&e.push(that.stringifyJSON(f)+":"+that.stringifyJSON(a[f]));return"{"+e.join(",")+"}";case"number":return a;case!1:return a;case"boolean":return a}},this.trim=function(a){return null===a?"":a.replace(/^\s+|\s+$/g,"")},this.uploader=function(a){var i,j,k,l,m,n,o,p,q,r,b=function(){var c,d,e,b=that.detectIEVersion(),f="Safari"===mOxie.Env.browser&&mOxie.Env.version<=5&&"Windows"===mOxie.Env.os&&"7"===mOxie.Env.osVersion||"Safari"===mOxie.Env.browser&&"iOS"===mOxie.Env.os&&"7"===mOxie.Env.osVersion;b&&9>b&&a.chunk_size&&a.runtimes.indexOf("flash")>=0?a.chunk_size=0:f?a.chunk_size=0:(c=20,d=4<<c,e=plupload.parseSize(a.chunk_size),e>d&&(a.chunk_size=d))},c=function(a){var c,d,b=[];for(c=0;c<a.length;c++)d=a[c],0===d.indexOf("-H")?b.push(d.split(" ")[2]):b.push(d);return b},d=function(a){var b=a.split(":"),c=b[0],d=that.parseJSON(that.URLSafeBase64Decode(b[2]));return d.ak=c,d.scope.indexOf(":")>=0?(d.bucket=d.scope.split(":")[0],d.key=d.scope.split(":")[1]):d.bucket=d.scope,d},e=function(b){var g,h,i,e=d(b),f=window.location.protocol+"//uc.qbox.me/v1/query?ak="+e.ak+"&bucket="+e.bucket;logger.debug("putPolicy: ",e),logger.debug("get uphosts from: ",f),g=that.detectIEVersion(),g&&9>=g?(h=new mOxie.XMLHttpRequest,mOxie.Env.swf_url=a.flash_swf_url):h=that.createAjax(),h.open("GET",f,!0),i=function(){if(logger.debug("ajax.readyState: ",h.readyState),4===h.readyState)if(logger.debug("ajax.status: ",h.status),h.status<400){var a=that.parseJSON(h.responseText);qiniuUpHosts.http=c(a.http.up),qiniuUpHosts.https=c(a.https.up),logger.debug("get new uphosts: ",qiniuUpHosts),that.resetUploadUrl()}else logger.error("get uphosts error: ",h.responseText)},g&&9>=g?h.bind("readystatechange",i):h.onreadystatechange=i,h.send()},f=function(a){return!that.token||that.tokenInfo.isExpired()?g(a):that.token},g=function(b){var c,d,f,g,h,i,j;return a.uptoken?that.token=a.uptoken:a.uptoken_url?(logger.debug("get uptoken from: ",that.uptoken_url),c=that.createAjax(),c.open("GET",that.uptoken_url,!1),c.setRequestHeader("If-Modified-Since","0"),c.send(),200===c.status?(d=that.parseJSON(c.responseText),that.token=d.uptoken,f=that.token.split(":"),g=that.parseJSON(that.URLSafeBase64Decode(f[2])),that.tokenMap||(that.tokenMap={}),h=function(a){return Math.ceil(a.getTime()/1e3)},i=h(new Date(c.getResponseHeader("date"))),j=h(new Date),that.tokenInfo={serverDelay:j-i,deadline:g.deadline,isExpired:function(){var a=this.deadline-h(new Date)+this.serverDelay;return 600>a}},logger.debug("get new uptoken: ",that.token),logger.debug("get token info: ",that.tokenInfo)):logger.error("get uptoken error: ",c.responseText)):a.uptoken_func?(logger.debug("get uptoken from uptoken_func"),that.token=a.uptoken_func(b),logger.debug("get new uptoken: ",that.token)):logger.error("one of [uptoken, uptoken_url, uptoken_func] settings in options is required!"),that.token&&e(that.token),that.token},h=function(b,c,d){var g,e="",f=!1;return a.save_key||(f=b.getOption&&b.getOption("unique_names"),f=f||b.settings&&b.settings.unique_names,f?(g=that.getFileExtension(c.name),e=g?c.id+"."+g:c.id):e="function"==typeof d?d(b,c):c.name),e};if(a.log_level&&(logger.level=a.log_level),!a.domain)throw"domain setting in options is required!";if(!a.browse_button)throw"browse_button setting in options is required!";if(!a.uptoken&&!a.uptoken_url&&!a.uptoken_func)throw"one of [uptoken, uptoken_url, uptoken_func] settings in options is required!";return logger.debug("init uploader start"),logger.debug("environment: ",mOxie.Env),logger.debug("userAgent: ",navigator.userAgent),i={},j=a.init&&a.init.Error,k=a.init&&a.init.FileUploaded,a.init.Error=function(){},a.init.FileUploaded=function(){},that.uptoken_url=a.uptoken_url,that.token="",that.key_handler="function"==typeof a.init.Key?a.init.Key:"",this.domain=a.domain,l="",m={isResumeUpload:!1,resumeFilesize:0,startTime:"",currentTime:""},b(),logger.debug("invoke reset_chunk_size()"),logger.debug("op.chunk_size: ",a.chunk_size),n={url:qiniuUploadUrl,multipart_params:{token:""}},o=that.detectIEVersion(),o&&9>=o&&(n.multipart_params.accept="text/plain; charset=utf-8",logger.debug("add accept text/plain in multipart params")),plupload.extend(i,a,n),logger.debug("option: ",i),p=new plupload.Uploader(i),logger.debug("new plupload.Uploader(option)"),p.bind("Init",function(){logger.debug("Init event activated"),a.get_new_uptoken||g(null)}),logger.debug("bind Init event"),p.bind("FilesAdded",function(a,b){var c,d,e,f,g;if(logger.debug("FilesAdded event activated"),c=a.getOption&&a.getOption("auto_start"),c=c||a.settings&&a.settings.auto_start,logger.debug("auto_start: ",c),logger.debug("files: ",b),d=function(){return"ios"===mOxie.Env.OS.toLowerCase()?!0:!1},d())for(e=0;e<b.length;e++)f=b[e],g=that.getFileExtension(f.name),f.name=f.id+"."+g;c&&setTimeout(function(){a.start(),logger.debug("invoke up.start()")},0),a.refresh()}),logger.debug("bind FilesAdded event"),p.bind("BeforeUpload",function(b,c){var d,e,i,j,k,n,o,q,r,s;logger.debug("BeforeUpload event activated"),c.speed=c.speed||0,l="",a.get_new_uptoken&&g(c),d=function(b,c,d){var f,g,i,j;if(m.startTime=(new Date).getTime(),f=a.save_key?{token:that.token}:{key:h(b,c,d),token:that.token},g=that.detectIEVersion(),g&&9>=g&&(f.accept="text/plain; charset=utf-8",logger.debug("add accept text/plain in multipart params")),logger.debug("directUpload multipart_params_obj: ",f),i=a.x_vars,void 0!==i&&"object"==typeof i)for(j in i)i.hasOwnProperty(j)&&("function"==typeof i[j]?f["x:"+j]=i[j](b,c):"object"!=typeof i[j]&&(f["x:"+j]=i[j]));b.setOption({url:qiniuUploadUrl,multipart:!0,chunk_size:e()?a.max_file_size:void 0,multipart_params:f})},e=function(){var a=navigator.userAgent.toLowerCase();return(a.match(/MicroMessenger/i)||"QQBrowser"===mOxie.Env.browser||a.match(/V1_AND_SQ/i))&&"android"===mOxie.Env.OS.toLowerCase()?!0:!1},i=b.getOption&&b.getOption("chunk_size"),i=i||b.settings&&b.settings.chunk_size,logger.debug("uploader.runtime: ",p.runtime),logger.debug("chunk_size: ",i),"html5"!==p.runtime&&"flash"!==p.runtime||!i?(logger.debug("directUpload because uploader.runtime !== 'html5' || uploader.runtime !== 'flash' || !chunk_size"),d(b,c,that.key_handler)):c.size<i||e()?(logger.debug("directUpload because file.size < chunk_size || is_android_weixin_or_qq()"),d(b,c,that.key_handler)):(j=localStorage.getItem(c.name),k=i,j&&(j=that.parseJSON(j),n=(new Date).getTime(),o=j.time||0,q=864e5,q>n-o?100!==j.percent?c.size===j.total?(c.percent=j.percent,c.loaded=j.offset,l=j.ctx,m.isResumeUpload=!0,m.resumeFilesize=j.offset,j.offset+k>c.size&&(k=c.size-j.offset)):localStorage.removeItem(c.name):localStorage.removeItem(c.name):localStorage.removeItem(c.name)),m.startTime=(new Date).getTime(),r={},s=that.detectIEVersion(),s&&9>=s&&(r.accept="text/plain; charset=utf-8",logger.debug("add accept text/plain in multipart params")),b.setOption({url:qiniuUploadUrl+"/mkblk/"+k,multipart:!1,chunk_size:i,required_features:"chunks",headers:{Authorization:"UpToken "+f(c)},multipart_params:r}))}),logger.debug("bind BeforeUpload event"),p.bind("UploadProgress",function(a,b){var c,d;logger.trace("UploadProgress event activated"),m.currentTime=(new Date).getTime(),c=m.currentTime-m.startTime,d=b.loaded||0,m.isResumeUpload&&(d=b.loaded-m.resumeFilesize),b.speed=(1e3*(d/c)).toFixed(0)||0}),logger.debug("bind UploadProgress event"),p.bind("ChunkUploaded",function(a,b,c){var d,e,g;logger.debug("ChunkUploaded event activated"),logger.debug("file: ",b),logger.debug("info: ",c),d=that.parseJSON(c.response),logger.debug("res: ",d),l=l?l+","+d.ctx:d.ctx,e=c.total-c.offset,g=a.getOption&&a.getOption("chunk_size"),g=g||a.settings&&a.settings.chunk_size,g>e&&(a.setOption({url:qiniuUploadUrl+"/mkblk/"+e}),logger.debug("up.setOption url: ",qiniuUploadUrl+"/mkblk/"+e)),a.setOption({headers:{Authorization:"UpToken "+f(b)}}),localStorage.setItem(b.name,that.stringifyJSON({ctx:l,percent:b.percent,total:c.total,offset:c.offset,time:(new Date).getTime()}))}),logger.debug("bind ChunkUploaded event"),q=qiniuUploadUrls.length,r=function(a){return q-->0?(setTimeout(function(){that.resetUploadUrl(),a.status=plupload.QUEUED,p.stop(),p.start()},0),!0):(q=qiniuUploadUrls.length,!1)},p.bind("Error",function(a){return function(b,c){var d,e,f,g,h;if(logger.error("Error event activated"),logger.error("err: ",c),d="",e=c.file){switch(c.code){case plupload.FAILED:d="上传失败。请稍后再试。";break;case plupload.FILE_SIZE_ERROR:f=b.getOption&&b.getOption("max_file_size"),f=f||b.settings&&b.settings.max_file_size,d="浏览器最大可上传"+f+"。更大文件请使用命令行工具。";break;case plupload.FILE_EXTENSION_ERROR:d="文件验证失败。请稍后重试。";break;case plupload.HTTP_ERROR:if(""===c.response){if(d=c.message||"未知网络错误。",!r(e))return;break}switch(g=that.parseJSON(c.response),h=g.error,c.status){case 400:d="请求报文格式错误。";break;case 401:d="客户端认证授权失败。请重试或提交反馈。";break;case 405:d="客户端请求错误。请重试或提交反馈。";break;case 579:d="资源上传成功，但回调失败。";break;case 599:if(d="网络连接异常。请重试或提交反馈。",!r(e))return;break;case 614:d="文件已存在。";try{g=that.parseJSON(g.error),h=g.error||"file exists"}catch(i){h=g.error||"file exists"}break;case 631:d="指定空间不存在。";break;case 701:d="上传数据块校验出错。请重试或提交反馈。";break;default:if(d="未知错误。",!r(e))return}d=d+"("+c.status+"："+h+")";break;case plupload.SECURITY_ERROR:d="安全配置错误。请联系网站管理员。";break;case plupload.GENERIC_ERROR:d="上传失败。请稍后再试。";break;case plupload.IO_ERROR:d="上传失败。请稍后再试。";break;case plupload.INIT_ERROR:d="网站配置错误。请联系网站管理员。",p.destroy();break;default:if(d=c.message+c.details,!r(e))return}a&&a(b,c,d)}b.refresh()}}(j)),logger.debug("bind Error event"),p.bind("FileUploaded",function(b){return function(c,d,e){var f,g,i,j,k,m,n,o,q,r,s,t;if(logger.debug("FileUploaded event activated"),logger.debug("file: ",d),logger.debug("info: ",e),f=function(c,d,e){if(a.downtoken_url){var f=that.createAjax();f.open("POST",a.downtoken_url,!0),f.setRequestHeader("Content-type","application/x-www-form-urlencoded"),f.onreadystatechange=function(){var a,h;if(4===f.readyState)if(200===f.status){try{a=that.parseJSON(f.responseText)}catch(g){throw"invalid json format"}h={},plupload.extend(h,that.parseJSON(e),a),b&&b(c,d,that.stringifyJSON(h))}else p.trigger("Error",{status:f.status,response:f.responseText,file:d,code:plupload.HTTP_ERROR})},f.send("key="+that.parseJSON(e).key+"&domain="+a.domain)}else b&&b(c,d,e)},g=that.parseJSON(e.response),l=l?l:g.ctx,logger.debug("ctx: ",l),l){if(i="",logger.debug("save_key: ",a.save_key),a.save_key||(i=h(c,d,that.key_handler),i=i?"/key/"+that.URLSafeBase64Encode(i):""),j="/fname/"+that.URLSafeBase64Encode(d.name),logger.debug("op.x_vars: ",a.x_vars),k=a.x_vars,m="",n="",void 0!==k&&"object"==typeof k)for(o in k)k.hasOwnProperty(o)&&("function"==typeof k[o]?m=that.URLSafeBase64Encode(k[o](c,d)):"object"!=typeof k[o]&&(m=that.URLSafeBase64Encode(k[o])),n+="/x:"+o+"/"+m);q=qiniuUploadUrl+"/mkfile/"+d.size+i+j+n,r=that.detectIEVersion(),r&&9>=r?(s=new mOxie.XMLHttpRequest,mOxie.Env.swf_url=a.flash_swf_url):s=that.createAjax(),s.open("POST",q,!0),s.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),s.setRequestHeader("Authorization","UpToken "+that.token),t=function(){if(logger.debug("ajax.readyState: ",s.readyState),4===s.readyState){localStorage.removeItem(d.name);var a;200===s.status?(a=s.responseText,logger.debug("mkfile is success: ",a),f(c,d,a)):(a={status:s.status,response:s.responseText,file:d,code:-200},logger.debug("mkfile is error: ",a),p.trigger("Error",a))}},r&&9>=r?s.bind("readystatechange",t):s.onreadystatechange=t,s.send(l),logger.debug("mkfile: ",q)}else f(c,d,e.response)}}(k)),logger.debug("bind FileUploaded event"),p.init(),logger.debug("invoke uploader.init()"),logger.debug("init uploader end"),p},this.getUrl=function(a){if(!a)return!1;a=encodeURI(a);var b=this.domain;return"/"!==b.slice(b.length-1)&&(b+="/"),b+a},this.imageView2=function(a,b){var h,c=a.mode||"",d=a.w||"",e=a.h||"",f=a.q||"",g=a.format||"";return c?d||e?(h="imageView2/"+c,h+=d?"/w/"+d:"",h+=e?"/h/"+e:"",h+=f?"/q/"+f:"",h+=g?"/format/"+g:"",b&&(h=this.getUrl(b)+"?"+h),h):!1:!1},this.imageMogr2=function(a,b){var c=a["auto-orient"]||"",d=a.thumbnail||"",e=a.strip||"",f=a.gravity||"",g=a.crop||"",h=a.quality||"",i=a.rotate||"",j=a.format||"",k=a.blur||"",l="imageMogr2";return l+=c?"/auto-orient":"",l+=d?"/thumbnail/"+d:"",l+=e?"/strip":"",l+=f?"/gravity/"+f:"",l+=h?"/quality/"+h:"",l+=g?"/crop/"+g:"",l+=i?"/rotate/"+i:"",l+=j?"/format/"+j:"",l+=k?"/blur/"+k:"",b&&(l=this.getUrl(b)+"?"+l),l},this.watermark=function(a,b){var d,e,f,g,h,i,j,k,l,m,c=a.mode;if(!c)return!1;if(d="watermark/"+c,1===c){if(e=a.image||"",!e)return!1;d+=e?"/image/"+this.URLSafeBase64Encode(e):""}else{if(2!==c)return!1;if(f=a.text?a.text:"",g=a.font?a.font:"",h=a.fontsize?a.fontsize:"",i=a.fill?a.fill:"",!f)return!1;d+=f?"/text/"+this.URLSafeBase64Encode(f):"",d+=g?"/font/"+this.URLSafeBase64Encode(g):"",d+=h?"/fontsize/"+h:"",d+=i?"/fill/"+this.URLSafeBase64Encode(i):""}return j=a.dissolve||"",k=a.gravity||"",l=a.dx||"",m=a.dy||"",d+=j?"/dissolve/"+j:"",d+=k?"/gravity/"+k:"",d+=l?"/dx/"+l:"",d+=m?"/dy/"+m:"",b&&(d=this.getUrl(b)+"?"+d),d},this.imageInfo=function(a){var b,c,d,e;return a?(b=this.getUrl(a)+"?imageInfo",c=this.createAjax(),e=this,c.open("GET",b,!1),c.onreadystatechange=function(){4===c.readyState&&200===c.status&&(d=e.parseJSON(c.responseText))},c.send(),d):!1},this.exif=function(a){var b,c,d,e;return a?(b=this.getUrl(a)+"?exif",c=this.createAjax(),e=this,c.open("GET",b,!1),c.onreadystatechange=function(){4===c.readyState&&200===c.status&&(d=e.parseJSON(c.responseText))},c.send(),d):!1},this.get=function(a,b){return b&&a?"exif"===a?this.exif(b):"imageInfo"===a?this.imageInfo(b):!1:!1},this.pipeline=function(a,b){var d,e,g,h,i,c="[object Array]"===Object.prototype.toString.call(a),f="";if(c){for(g=0,h=a.length;h>g;g++){if(d=a[g],!d.fop)return!1;switch(d.fop){case"watermark":f+=this.watermark(d)+"|";break;case"imageView2":f+=this.imageView2(d)+"|";break;case"imageMogr2":f+=this.imageMogr2(d)+"|";break;default:e=!0}if(e)return!1}return b&&(f=this.getUrl(b)+"?"+f,i=f.length,"|"===f.slice(i-1)&&(f=f.slice(0,i-1))),f}return!1}}window.localStorage||(window.localStorage={setItem:function(a,b){createCookie(a,b,30)},getItem:function(a){return readCookie(a)},removeItem:function(a){createCookie(a,"",-1)}});var Qiniu=new QiniuJsSDK;global.Qiniu=Qiniu,global.QiniuJsSDK=QiniuJsSDK}(window);